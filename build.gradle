apply plugin: 'scala'
apply plugin: 'maven-publish'
apply plugin: 'idea'

version = projectVersion
group = artifactGroup

tasks.withType(ScalaCompile) {
    scalaCompileOptions.fork = true
    scalaCompileOptions.useAnt = false
    scalaCompileOptions.deprecation = true
    scalaCompileOptions.unchecked = true

    configure(scalaCompileOptions.forkOptions) {
      memoryMaximumSize = '1g'
      jvmArgs = ['-XX:MaxPermSize=512m']
    }
}

dependencies {
    compile "org.scala-lang:scala-compiler:$scalaVersion"
    compile "org.scala-lang:scala-library:$scalaVersion"
    compile "com.googlecode.scalascriptengine:scalascriptengine:1.3.7-$scalaVersion"

    testCompile 'junit:junit:4.11'
    testCompile 'org.scalatest:scalatest_2.10:2.0.M5b'
    testCompile 'org.scalamock:scalamock-scalatest-support_2.10:3.0.1'
    testCompile 'org.scalacheck:scalacheck_2.10:1.11.1'
}

repositories {
    mavenLocal()
    mavenCentral()
    maven {
        name: 'sonatype-releases'
        url: "https://oss.sonatype.org/content/repositories/releases"
    }
}

publishToMavenLocal.dependsOn test

test {
    jvmArgs '-XX:MaxPermSize=256m'
    systemProperties = System.getProperties()
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
        }
    }
}
